(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{383:function(s,n,a){s.exports=a.p+"assets/img/image.fab16997.png"},384:function(s,n,a){s.exports=a.p+"assets/img/image2.560710c1.png"},385:function(s,n,a){s.exports=a.p+"assets/img/image3.4be9836e.png"},386:function(s,n,a){s.exports=a.p+"assets/img/image4.7d5a3721.png"},387:function(s,n,a){s.exports=a.p+"assets/img/image5.37f6c7ce.png"},388:function(s,n,a){s.exports=a.p+"assets/img/image6.5ed76eb3.png"},389:function(s,n,a){s.exports=a.p+"assets/img/image7.d5f5f564.png"},390:function(s,n,a){s.exports=a.p+"assets/img/image8.8e7e8810.png"},391:function(s,n,a){s.exports=a.p+"assets/img/image9.c8be8362.png"},392:function(s,n,a){s.exports=a.p+"assets/img/image10.aaf010e2.png"},393:function(s,n,a){s.exports=a.p+"assets/img/image11.a2d52708.png"},539:function(s,n,a){"use strict";a.r(n);var t=a(46),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"ä»é›¶å¼€å§‹æ•™ä½ ç”¨-docker-éƒ¨ç½²-jenkins-ä¸ºä½ çš„é¡¹ç›®å®ç°ci-cd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»é›¶å¼€å§‹æ•™ä½ ç”¨-docker-éƒ¨ç½²-jenkins-ä¸ºä½ çš„é¡¹ç›®å®ç°ci-cd"}},[s._v("#")]),s._v(" ä»é›¶å¼€å§‹æ•™ä½ ç”¨ Docker éƒ¨ç½² Jenkinsï¼Œä¸ºä½ çš„é¡¹ç›®å®ç°CI/CD")]),s._v(" "),t("p",[s._v("æœ¬æ–‡é€‚åˆå°šæœªäº†è§£ Docker æˆ– Jenkins çš„äººç¾¤ï¼Œå°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Docker æ­å»ºGilabä»£ç ä»“åº“å’ŒJenkinsï¼Œå¹¶ä»¥å‰ç«¯é¡¹ç›®ã€Gitlabä½œä¸ºä»£ç ä»“åº“ä¸ºä¾‹ï¼Œå®ç°å¼€å‘äººå‘˜æäº¤ä»£ç åï¼Œæ ¹æ®ä¸åŒåˆ†æ”¯ï¼Œè‡ªåŠ¨æ„å»ºé¡¹ç›®ï¼Œå¹¶éƒ¨ç½²è‡³å¯¹åº”ç¯å¢ƒã€‚å®é™…ä¸Šä»»ä½•é¡¹ç›®ã€ä»»æ„ä¸»æµä»£ç ä»“åº“ï¼ˆå¦‚ï¼šgitlabã€githubã€giteeã€bitbucketç­‰ï¼‰çš†å¯ã€‚\nâ€‹\né˜…è¯»æœ¬æ–‡ï¼Œåªéœ€è¦ä½ ")]),s._v(" "),t("ul",[t("li",[s._v("ä¼šä½¿ç”¨ç™¾åº¦ï¼ˆor Googleï¼‰å’Œ git å…‹éš†ã€æäº¤ä»£ç ï¼Œ")]),s._v(" "),t("li",[s._v("äº†è§£ Webå‰ç«¯ çš„éƒ¨ç½²ï¼Œæ˜¯å°† html ä¸Šä¼ è‡³ nginx æ˜ å°„çš„ç›®å½•")]),s._v(" "),t("li",[s._v("äº†è§£ linux å¸¸ç”¨æ“ä½œï¼ˆå¦‚ï¼š"),t("code",[s._v("cdã€lsã€catã€echoã€ssh")]),s._v(" ç­‰ ï¼‰å³å¯")])]),s._v(" "),t("h2",{attrs:{id:"ä»€ä¹ˆæ˜¯ci-cd-jenkinsèƒ½åšä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯ci-cd-jenkinsèƒ½åšä»€ä¹ˆ"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯CI/CDï¼ŒJenkinsèƒ½åšä»€ä¹ˆ")]),s._v(" "),t("p",[s._v("å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šå‡ºç°å¤šåˆ†æ”¯å¹¶è¡Œå¼€å‘ï¼Œå¹¶éœ€éƒ¨ç½²è‡³å¤šä¸ªç¯å¢ƒï¼Œå¦‚æœè¿™äº›æ“ä½œéƒ½æœ‰ä¸“äººæˆ–è€…å¼€å‘äººå‘˜è‡ªå·±å¤„ç†ï¼Œé‚£æ¯«æ— ç–‘é—®æ˜¯å·¨å¤§ã€ä¸”é‡å¤çš„å·¥ä½œé‡ã€‚åœ¨ç¨‹åºå‘˜çš„ä¸–ç•Œï¼Œé‡å¤çš„å·¥ä½œä¸œè¥¿å°±åº”è¯¥è‡ªåŠ¨åŒ– ï¼Œè€Œ Jenkins å°±æ˜¯ä¸º "),t("strong",[s._v("æŒç»­æ„å»ºï¼ˆæŒç»­é›†æˆï¼ŒCIï¼‰")]),s._v(" ã€ "),t("strong",[s._v("æŒç»­éƒ¨ç½²ï¼ˆæŒç»­äº¤ä»˜ï¼ŒCDï¼‰")]),s._v(" çš„ "),t("strong",[s._v("è‡ªåŠ¨åŒ–ã€å¯è§†åŒ–")]),s._v(" æ“ä½œæä¾›è§£å†³æ–¹æ¡ˆã€‚\nâ€‹")]),s._v(" "),t("p",[s._v("é€šä¿—çš„è¯´ï¼Œæ•´ä¸ªæµç¨‹é€šè¿‡ ã€gitä»“åº“é€šè¿‡æäº¤ä»£ç è§¦å‘Hooké€šçŸ¥Jenkinsã€‘æˆ–è€…ã€Jenkins è½®è¯¢æ‰«ææ£€æŸ¥æ›´æ–°ã€‘ç­‰...ï¼Œè§¦å‘ç›¸å…³ä»»åŠ¡æˆ–æµæ°´çº¿çš„è„šæœ¬çš„æ‰§è¡Œã€‚è€Œ Jenkins ä»…ä½œä¸ºè§¦å‘å™¨ã€å¯è§†åŒ–çš„å·¥å…·ï¼Œç›¸å…³çš„æ„å»ºã€éƒ¨ç½²éƒ½éœ€è¦è‡ªè¡Œé€šè¿‡è„šæœ¬å®ç°ã€‚å¦‚ï¼šshellã€nodejsã€python ç­‰ã€‚")]),s._v(" "),t("h2",{attrs:{id:"ä¸ºä»€ä¹ˆç”¨åˆ°äº†-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆç”¨åˆ°äº†-docker"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆç”¨åˆ°äº† Docker")]),s._v(" "),t("p",[s._v("Docker å¯ä»¥ç†è§£ä¸º linux çš„è™šæ‹Ÿæœºç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿ã€å¿«é€Ÿçš„åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆæ›´å‡†ç¡®æ˜¯å« "),t("strong",[s._v("å®¹å™¨")]),s._v("ï¼šDocker Containerï¼‰ï¼Œå¦‚ Alpine Linux ä»…æœ‰5mbå¤§å°ã€‚\nâ€‹")]),s._v(" "),t("p",[s._v("å°†ä»£ç å’Œä¸€äº›æœåŠ¡ï¼Œè·‘åœ¨åŒä¸€ä¸ªç‰ˆæœ¬çš„å®¹å™¨ä¸­ï¼Œå¯ä»¥ "),t("strong",[s._v("ç¡®ä¿ç¯å¢ƒä¸€è‡´")]),s._v(" ï¼Œè€Œä¸å—ç¡¬ä»¶ã€æœºå™¨æœ¬èº«æ“ä½œç³»ç»Ÿå½±å“ï¼Œè¿™åœ¨æœåŠ¡å™¨è¿ç§»ã€åˆ†å¸ƒå¼éƒ¨ç½²ã€æ„å»ºç­‰åœºæ™¯éå¸¸æœ‰ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œé€šè¿‡å®¹å™¨è·‘çš„é¡¹ç›®ï¼Œ "),t("strong",[s._v("å¯ä»¥è¿ç§»ã€éƒ¨ç½²ä»»æ„ä¸€å°å®‰è£…äº† Docker æœåŠ¡å™¨ä¸Š")]),s._v(" ï¼Œè€Œå‡ ä¹æ²¡æœ‰é£é™©ï¼Œåªéœ€è¦æ‹‰å–åŒæ ·çš„å®¹å™¨å³å¯ã€‚\nâ€‹")]),s._v(" "),t("p",[s._v("Docker æ—¢ç„¶å¦‚æ­¤é‡è¦ï¼Œå¾ˆæœ‰å¿…è¦å…ˆç®€å•çš„äº†è§£ä¸€ä¸‹ï¼šï¼ˆè‡ªè¡Œæœç´¢é€‚åˆè‡ªå·±ç³»ç»Ÿå®‰è£… Docker çš„æ–¹å¼ï¼‰")]),s._v(" "),t("h3",{attrs:{id:"docker-åŸºæœ¬æ¦‚å¿µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-åŸºæœ¬æ¦‚å¿µ"}},[s._v("#")]),s._v(" Docker åŸºæœ¬æ¦‚å¿µ")]),s._v(" "),t("p",[t("img",{attrs:{src:a(383),alt:"image.png"}})]),s._v(" "),t("ul",[t("li",[s._v("å®¿ä¸»æœºä»ä»“åº“ pull ä¸€ä¸ªé•œåƒï¼Œç„¶å run èµ·æ¥ï¼Œå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼ˆè™šæ‹Ÿæœºï¼‰äº†")]),s._v(" "),t("li",[s._v("è¿›å…¥å®¹å™¨ä¸€é¡¿æ“ä½œåï¼Œå¯ä»¥é€šè¿‡ commit å°†æ›´æ”¹ç•™åœ¨é•œåƒï¼Œå¦åˆ™å®¹å™¨åœæ­¢åæ›´æ”¹ä¸ä¼šä¿ç•™")]),s._v(" "),t("li",[s._v("é•œåƒå¯ä»¥ save å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–¹ä¾¿è¿ç§»")]),s._v(" "),t("li",[s._v("Dockerfile å¯ä»¥ä»…ç”¨ä¸€ä¸ªæ–‡ä»¶é…ç½®çš„æ–¹å¼æ¥å®šåˆ¶å‡ºä¸€ä¸ªé•œåƒï¼Œè€Œtagæ–‡ä»¶åˆ™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿäº†ã€‚")])]),s._v(" "),t("blockquote",[t("p",[s._v("docker é»˜è®¤è¿æ¥çš„å®˜æ–¹ä»“åº“æ˜¯ "),t("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/"),t("OutboundLink")],1),s._v(" ï¼Œå¯ä»¥è¿›å…¥æœç´¢ alpine è¯•è¯•ã€‚")])]),s._v(" "),t("h3",{attrs:{id:"docker-åŸºæœ¬æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-åŸºæœ¬æ“ä½œ"}},[s._v("#")]),s._v(" Docker åŸºæœ¬æ“ä½œ")]),s._v(" "),t("p",[s._v("æ‹‰å–é•œåƒ -> åˆ›å»ºå®¹å™¨ -> è¿›å…¥å®¹å™¨ -> æ“ä½œå®¹å™¨  -> åˆ é™¤å®¹å™¨ -> åˆ é™¤é•œåƒ")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ‹‰å– nginx:alpine é•œåƒï¼Œä¸å¸¦ç‰ˆæœ¬å·é»˜è®¤latestæœ€æ–°ç‰ˆæœ¬ï¼Œå®é™…é¡¹ç›®ä¸Šå¼ºçƒˆå»ºè®®å›ºå®šç‰ˆæœ¬")]),s._v("\n$ docker pull nginx:alpine\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŸ¥çœ‹å½“å‰æœ‰å“ªäº›é•œåƒï¼ˆå¯ä»¥æŸ¥çœ‹ IMAGE_ID ç­‰ï¼‰")]),s._v("\n$ docker images\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°†é•œåƒè¿è¡Œä¸ºå®¹å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d åå°è¿è¡Œ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 8080:80 ç«¯å£æ˜ å°„ï¼ˆportï¼‰ï¼Œå‰è€…ä¸ºå®¿ä¸»æœºç«¯å£ï¼Œåè€…ä¸ºå®¹å™¨ç«¯å£")]),s._v("\n$ docker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ­¤æ—¶å®¿ä¸»æœº 8080 ç«¯å£å·²ç»å¯ä»¥æŸ¥çœ‹åˆ° ğŸ‘‰ nginx çš„æ¬¢è¿é¡µã€‚")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŸ¥çœ‹è¿è¡Œé•œåƒï¼ˆå¯ä»¥æŸ¥çœ‹ CONTAINER_ID ã€CONTAINER_NAME ç­‰ï¼‰")]),s._v("\n$ docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯ä»¥å†æ¬¡è¿è¡Œï¼Œå³é•œåƒåˆ›å»ºç¬¬äºŒä¸ªå®¹å™¨ï¼ˆå®ä¾‹ï¼Œè¿è¡Œä¸ç¬¬ä¸€ä¸ªç›¸äº’éš”ç¦»ï¼Œä¸”ç‹¬ç«‹çš„ç³»ç»Ÿï¼‰")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è‡ªå·±å‡†å¤‡ä¸€ä¸ª index.html æ–‡ä»¶ï¼Œç„¶åå°†å…¶ç›®å½•ä¸ä¸‹æ–¹çš„ â€œ/YOUR_HTML_DIRâ€ æ›¿æ¢")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v /YOUR_HTML_DIR:/usr/share/nginx/html ç›®å½•æ˜ å°„ï¼ˆvolumeï¼‰ï¼Œå‰è€…ä¸ºå®¿ä¸»æœºç›®å½•ï¼Œåè€…ä¸ºå®¹å™¨ç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --name my_html_nginx ç»™å®¹å™¨èµ·ä¸ªåå­—ï¼Œå¯ç”¨æ¥ä»£æ›¿ CONTAINER_ID")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å½“ç„¶ï¼Œ8080 ç«¯å£è¢«å ç”¨äº†ï¼Œè¿™é‡Œç”¨ 8081 ç«¯å£ã€‚")]),s._v("\n$ docker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":80 nginx -v /YOUR_HTML_DIR:/usr/share/nginx/html --name my_html_nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ­¤æ—¶å®¿ä¸»æœº 8081 ç«¯å£å·²ç»å¯ä»¥æŸ¥çœ‹åˆ° ğŸ‘‰ è‡ªå·±å‡†å¤‡çš„ html æ–‡ä»¶")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å®¹å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# my_html_nginx ä¸º CONTAINER_NAME")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¹Ÿå¯ä»¥ç”¨ CONTAINER_ID, ä½¿ç”¨ä»»æ„èƒ½å”¯ä¸€åŒ¹é…çš„é•¿åº¦å³å¯")]),s._v("\n$ docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it my_html_nginx "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯ä»¥ `cd /usr/share/nginx/html` çœ‹çœ‹è‡ªå·±çš„htmlæ–‡ä»¶")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ vi ä¿®æ”¹ html æ–‡ä»¶")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é€€å‡ºå®¹å™¨")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ é™¤å®¹å™¨")]),s._v("\n$ docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f /*CONTAINER_ID*/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ é™¤é•œåƒ")]),s._v("\n$ docker rmi -f /*IMAGE_ID*/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br")])]),t("p",[s._v("å¦‚æœè¦æ±‚å®¹å™¨éœ€è¦è‡ªå¸¦ä¸€äº›è‡ªå·±å®šåˆ¶çš„ä¸€äº›å·¥å…·å’Œé…ç½®ï¼Œæ­¤æ—¶å»ºè®®ä½¿ç”¨ "),t("code",[s._v("Dockerfile")]),s._v(" æ¥å®šåˆ¶æ„å»ºé•œåƒï¼Œä¸‹é¢ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»æœç´¢ç›¸å…³è¯­æ³•ã€‚")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/YOUR_HTML_DIR"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/share/nginx/html"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# build å‡ºé•œåƒåï¼Œrun æ—¶ï¼Œä»éœ€ -p æŒ‡å®šç«¯å£æ˜ å°„")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8081\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("å°†è¯¥ Dockerfile å†™å…¥åˆ°ä¸€ä¸ªç©ºç›®å½•ã€‚å¹¶ "),t("code",[s._v("cd")]),s._v(" åˆ°è¯¥ç›®å½• ï¼Œæ‰§è¡Œï¼š "),t("code",[s._v("docker build -t name1:tag1 .")]),s._v("ï¼ˆæ³¨æ„åé¢æœ‰ä¸ªç‚¹ï¼‰ï¼Œå°±å¯ä»¥é€šè¿‡ "),t("code",[s._v("docker images")]),s._v(" æŸ¥çœ‹åˆ°æ„å»ºå‡ºçš„ é•œåƒã€‚")]),s._v(" "),t("h3",{attrs:{id:"docker-compose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker Compose")]),s._v(" "),t("p",[s._v("å¯ä»¥é€šè¿‡ "),t("code",[s._v("docker run")]),s._v(" è·‘èµ·å®¹å™¨ï¼Œéœ€è¦å¤§é‡é…ç½®å‚æ•°æ”¯æ’‘ï¼Œéƒ½å†™æˆå‘½ä»¤å‚æ•°å¯è¯»æ€§éå¸¸å·®ã€‚æ­¤å¤–ï¼Œå®¹å™¨é—´ç›¸äº’é€šä¿¡ä¹Ÿå°†æˆä¸ºéšœç¢ã€‚")]),s._v(" "),t("blockquote",[t("ol",[t("li",[s._v("ä¸ºä»€ä¹ˆä¼šæœ‰éšœç¢ï¼Ÿ")])]),s._v(" "),t("p",[s._v("ç­”ï¼šDocker ç½‘å¡ä¼šä¸ºæ¯ä¸ªå®¹å™¨åˆ†é…ä¸€ä¸ªå†…ç½‘ ipï¼Œä½†æ˜¯å®¹å™¨ä¹‹é—´å¹¶ä¸çŸ¥é“å¯¹æ–¹ä¼šè¢«åˆ†é…åˆ°ä»€ä¹ˆ ip\nâ€‹")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("ä¸Šè¿°_ Docker åŸºæœ¬æ“ä½œ _ä¸­ï¼Œç¬¬äºŒä¸ªå¯åŠ¨çš„ "),t("code",[s._v("my_html_nginx")]),s._v(" å®¹å™¨ï¼Œèƒ½é€šè¿‡ "),t("code",[s._v("127.0.0.1:8080")]),s._v(" è®¿é—®åˆ°ç¬¬ä¸€ä¸ªå¯åŠ¨çš„å®¹å™¨å—ï¼Ÿ")])]),s._v(" "),t("p",[s._v("ç­”ï¼šä¸èƒ½ï¼Œ"),t("code",[s._v("127.0.0.1")]),s._v(" æŒ‡å‘å®¹å™¨æœ¬èº«ï¼Œè€Œéå®¿ä¸»æœºï¼Œåº”è¯¥é€šè¿‡docker "),t("strong",[s._v("å†…ç½‘ ip")]),s._v(" è®¿é—®å…¶ "),t("strong",[s._v("æœ¬èº«çš„ç«¯å£")]),s._v("ï¼Œå¦‚ "),t("code",[s._v("172.17.0.2:80")]),s._v(" ï¼Œè€Œä¸æ˜¯ å¤–éƒ¨çš„ 8080ã€‚\nâ€‹")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("æ€ä¹ˆæŸ¥çœ‹å®¹å™¨çš„è¢«åˆ†é…çš„å†…ç½‘ ipï¼Ÿ")])]),s._v(" "),t("p",[s._v("ç­”ï¼š"),t("code",[s._v("ifconfig")]),s._v(" or  æŸ¥çœ‹hosts "),t("code",[s._v("cat /etc/hosts")])])]),s._v(" "),t("p",[s._v("é‚£ä¹ˆå®¹å™¨ä¸å®¹å™¨ä¹‹é—´æ€ä¹ˆé€šä¿¡å‘¢ï¼Ÿ")]),s._v(" "),t("ol",[t("li",[s._v("æ‰‹åŠ¨æŸ¥çœ‹æ¯ä¸ªå®¹å™¨ ipï¼Œä¿®æ”¹æ¯ä¸ªå®¹å™¨ hostsã€éå¸¸ä¸å®ç”¨ã€‘")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ "),t("code",[s._v("--link")]),s._v("ï¼Œä½†åªèƒ½å•å‘é€šä¿¡ï¼š"),t("code",[s._v("run")]),s._v(" æ—¶ä½¿ç”¨ "),t("code",[s._v("--link /* CONTAINER_ID:HOST_NAME */")]),s._v(" ï¼Œåœ¨è¿™ä¸ªåˆšèµ·çš„å®¹å™¨å†…ï¼Œå¯ä»¥é€šè¿‡ HOST_NAME è®¿é—®è¯¥ CONTAINER_ID çš„å®¹å™¨ï¼Œè€Œè¯¥ CONTAINER_ID å®¹å™¨ï¼Œæ— æ³•è®¿é—®åˆ°è¿™ä¸ªåˆšèµ·çš„å®¹å™¨ã€‚ã€éå¸¸ä¸å®ç”¨ã€‘")]),s._v(" "),t("li",[s._v("é€šè¿‡ docker-compose ç¼–æ’å®¹å™¨ï¼Œæ˜¯é€šè¿‡ä¸€ä¸ª yml æ–‡ä»¶ï¼Œå°±èƒ½è¿è¡Œå¤šä¸ªå®¹å™¨çš„ç¥å™¨ã€‚å…¶ä¼šè‡ªåŠ¨çš„å°†å®šä¹‰å®¹å™¨çš„ "),t("code",[s._v("key")]),s._v(" å€¼ï¼Œä½œä¸ºæ¯ä¸ªå®¹å™¨çš„åŸŸåæ˜ å°„ã€‚å½“ç„¶äº†ï¼Œdocker-compose éœ€è‡ªè¡Œæœç´¢å®‰è£…æ–¹å¼ã€‚")])]),s._v(" "),t("p",[s._v("ä¸‹é¢ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œ"),t("code",[s._v("nginx01")]),s._v(" å’Œ "),t("code",[s._v("nginx02")]),s._v(" ä½œä¸ºå®¹å™¨çš„ "),t("code",[s._v("key")]),s._v(" å€¼ã€‚")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mynginx01\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8080"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx02")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mynginx02\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8081"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å°†ä¸Šè¿°é…ç½®ä¿å­˜ä¸º docker-compose.yml æ–‡ä»¶ï¼Œå¹¶cdåˆ°è¯¥ç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯åŠ¨ docker-compose ï¼Œup å¯åŠ¨ï¼Œ-d æ˜¯åå°è¿è¡Œ")]),s._v("\n$ docker-compose up -d\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å®¹å™¨ mynginx02")]),s._v("\n$ docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mynginx02 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚æœæ²¡æœ‰ curl ï¼Œåˆ™æ‰§è¡Œ apk add curl")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚æœæœ‰å°±å°è¯•è¿æ¥ä¸€ä¸‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯ä»¥çœ‹åˆ°è¿”å›ä¸€ä¸ª nginx01 çš„æ¬¢è¿é¡µ")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" nginx02:80\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ³¨æ„ä¸æ˜¯ 8080")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("â€‹\nåˆ°æ­¤ï¼Œç›¸ä¿¡ä½ å·²ç»åŸºæœ¬ä¼šä½¿ç”¨ Dockerã€docker-compose äº†ï¼Œä¸‹é¢å›åˆ°ä¸»é¢˜")]),s._v(" "),t("h2",{attrs:{id:"ç¡¬ä»¶ç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¡¬ä»¶ç¯å¢ƒ"}},[s._v("#")]),s._v(" ç¡¬ä»¶ç¯å¢ƒ")]),s._v(" "),t("p",[s._v("ç†è®ºä¸Šï¼Œéœ€è¦ä¸‰å°æœåŠ¡å™¨ã€‚ä½†å› ä¸ºç¬”è€…èµ„é‡‘æœ‰é™ï¼Œä»…æœ‰ä¸€å°ç”µè„‘ï¼Œé€šè¿‡ä¸‰ä¸ª Docker å®¹å™¨ï¼ˆè™šæ‹Ÿæœºï¼‰ï¼Œä»£æ›¿ä¸‰å°æœåŠ¡å™¨\nä¸‰å°æœåŠ¡å™¨çš„ä½œç”¨æ˜¯åˆ†åˆ«éƒ¨ç½²ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("gitlabï¼šä»£ç ä»“åº“")]),s._v(" "),t("li",[s._v("jenkinsï¼šä¸»æµçš„ CI/CD å·¥å…·")]),s._v(" "),t("li",[s._v("nginxï¼šä½œä¸ºé¡¹ç›®éƒ¨ç½²çš„æœåŠ¡å™¨ï¼Œæ­¤å¤„ç”¨ä¸åŒç›®å½•ä»£è¡¨ä¸åŒç¯å¢ƒï¼ˆæ¨¡æ‹Ÿå®é™…é¡¹ç›®ä¸Šï¼Œä¸åŒç¯å¢ƒå¯¹åº”ä¸åŒæœåŠ¡å™¨ï¼‰ã€‚")])]),s._v(" "),t("p",[s._v("ç¬”è€…ç”µè„‘ï¼šwin10 20H2 wsl2 Ubuntu 20.04.2 LTSã€Docker version 20.10.6ã€docker-compose version 1.29.2ï¼ˆç¡¬ä»¶è¦æ±‚ï¼šå†…å­˜16gä»¥ä¸Šï¼Œå…¶ä½™ç¯å¢ƒåªè¦æœ‰äº†dockerï¼Œå°±æ— æ‰€è°“äº†ï¼‰")]),s._v(" "),t("h2",{attrs:{id:"éƒ¨ç½²-gitlabã€jenkinsã€nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²-gitlabã€jenkinsã€nginx"}},[s._v("#")]),s._v(" éƒ¨ç½² gitlabã€jenkinsã€nginx")]),s._v(" "),t("h3",{attrs:{id:"éƒ¨ç½²è„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²è„šæœ¬"}},[s._v("#")]),s._v(" éƒ¨ç½²è„šæœ¬")]),s._v(" "),t("p",[s._v("ä½¿ç”¨dockerï¼Œåˆ†åˆ«åˆ›å»ºä¸‰å°æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¿™ä¸‰å°æœåŠ¡å™¨ä¹‹é—´è¿˜éœ€è¦é€šä¿¡ï¼Œæ‰€ä»¥ç”¨åˆ° docker-compose æ¥ç¼–æ’å®¹å™¨ã€‚ï¼ˆå¦‚æœä½ æœ‰ä¸‰å°æœåŠ¡å™¨ï¼Œåˆ™å¯åˆ†å¼€éƒ¨ç½²ï¼Œé€šè¿‡æœåŠ¡å™¨ä¹‹é—´é€šè¿‡å†…ç½‘ipè®¿é—®å³å¯ï¼‰")]),s._v(" "),t("p",[s._v("åˆ›å»ºè„šæœ¬å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("version: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\nservices:\n  nginx:\n    container_name: mynginx\n    image: nginx:alpine\n    ports:\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80\n      - "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8022:22"')]),s._v("\n    volumes:\n      - /home/vito/project:/usr/share/nginx/html\n      - /home/vito/docker_nginx_data/log:/var/log/nginx\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŒ‰éœ€é…ç½®ï¼Œå¦‚æœä½ äº†è§£ nginx çš„è¯")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/vito/docker_nginx_data/nginx.conf:/etc/nginx/nginx.conf")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - /home/vito/docker_nginx_data/conf.d/default.conf:/etc/nginx/conf.d/default.conf")]),s._v("\n    command:\n      - /bin/sh\n      - -c\n      - "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://mirrors.aliyun.com/alpine/v3.8/main/"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/apk/repositories\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://mirrors.aliyun.com/alpine/v3.8/community/"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/apk/repositories\n        apk update\n        apk "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" --no-cache openssh openrc tzdata\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/#PermitRootLogin.*/PermitRootLogin yes/g"')]),s._v(" /etc/ssh/sshd_config\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /root/.ssh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("700")]),s._v(" /root/.ssh/\n        ssh-keygen -A\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root:root"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chpasswd\n        apk del tzdata\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/cache/apk/*\n        /usr/sbin/sshd\n        nginx\n        nginx -s reload\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f /dev/null\n  gitlab:\n    container_name: mygitlab\n    image: gitlab/gitlab-ce:latest\n    ports:\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6490")]),s._v(":80\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6492")]),s._v(":443\n    privileged: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    volumes:\n      - /home/vito/docker_gitlab_data/etc:/etc/gitlab\n      - /home/vito/docker_gitlab_data/log:/var/log/gitlab\n      - /home/vito/docker_gitlab_data/opt:/var/opt/gitlab\n  jenkins:\n    container_name: myjenkins\n    image: jenkins/jenkins:lts\n    ports:\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6480")]),s._v(":8080\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6481")]),s._v(":50000\n      - "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6482")]),s._v(":45000\n    volumes:\n      - /home/vito/docker_jenkins_data:/var/jenkins_home\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br")])]),t("p",[s._v("ä¿å­˜ä¸º "),t("code",[s._v("docker-compose.yml")]),s._v(" æ–‡ä»¶ï¼Œé€šè¿‡ "),t("code",[s._v("docker-compose up -d")]),s._v(" å¯åŠ¨ã€‚\n"),t("strong",[s._v("æ³¨æ„")]),s._v("ï¼š")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("8022:22")]),s._v(" éœ€è¦åŠ ä¸Šå¼•å·ï¼Œä¸ç„¶å’Œymlè¯­æ³•æœ‰å†²çª")]),s._v(" "),t("li",[s._v("nginx command ä¼šè¦†ç›–åŸå‘½ä»¤ï¼Œæ‰€ä»¥åœ¨å®‰è£…ã€è¿è¡Œsshåï¼Œè¿˜éœ€è¦é‡å¯nginx")]),s._v(" "),t("li",[s._v('å®‰è£…sshï¼Œæ˜æ–‡åœ¨è„šæœ¬å†™äº†"root:root" (ç”¨æˆ·å:å¯†ç )ï¼Œè™½ç„¶ä¸å¤ªå¯¹ï¼Œä½†è¿™é‡Œä»…ç”¨æ¥å­¦ä¹ ï¼Œä¸”ä½œä¸ºæµ‹è¯•ç¯å¢ƒæœåŠ¡å™¨')])]),s._v(" "),t("h3",{attrs:{id:"éƒ¨ç½²ç»“æœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²ç»“æœ"}},[s._v("#")]),s._v(" éƒ¨ç½²ç»“æœ")]),s._v(" "),t("p",[s._v("é¡¹ç›®åˆ†åˆ«éƒ¨ç½²åœ¨ï¼ˆæ ¹æ®ç«¯å£æ˜ å°„ï¼Œä¸”éœ€è¦åœ¨å®¿ä¸»æœºè¡¥å……ä¸€ä¸ªé¡µé¢ï¼Œ/home/vito/project/k/index.htmlï¼‰ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("Ngnix å‰ç«¯é¡¹ç›®ï¼š"),t("a",{attrs:{href:"http://127.0.0.1/k/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://127.0.0.1/k/index.html"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("Gitlab: "),t("a",{attrs:{href:"http://127.0.0.1:6490",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://127.0.0.1:6490"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("Jenkins: "),t("a",{attrs:{href:"http://127.0.0.1:6480",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://127.0.0.1:6480"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"åˆå§‹åŒ–-gitlabã€jenkinsã€nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–-gitlabã€jenkinsã€nginx"}},[s._v("#")]),s._v(" åˆå§‹åŒ– gitlabã€jenkinsã€nginx")]),s._v(" "),t("p",[s._v("æ‰“å¼€ Gitlabã€Jenkins ç§ä¸€ç§ï¼Œè¯¥è®¾å¯†ç å°±è®¾å¯†ç ï¼Œè¯¥åˆ›å»ºè´¦æˆ·å°±åˆ›å»ºï¼Œæ ¹æ® UI æç¤ºæ“ä½œå³å¯ã€‚\nè¿™é‡Œéœ€è¦"),t("strong",[s._v("æ³¨æ„")])]),s._v(" "),t("ul",[t("li",[s._v("gitlabåˆå§‹è´¦æˆ·åç§°æ˜¯ï¼šroot")]),s._v(" "),t("li",[s._v("jenkinså®‰è£… "),t("strong",[s._v("æ¨èæ’ä»¶")])])]),s._v(" "),t("h3",{attrs:{id:"gitlab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gitlab"}},[s._v("#")]),s._v(" gitlab")]),s._v(" "),t("h4",{attrs:{id:"åˆå§‹åŒ–é¡¹ç›®ä»£ç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–é¡¹ç›®ä»£ç "}},[s._v("#")]),s._v(" åˆå§‹åŒ–é¡¹ç›®ä»£ç ")]),s._v(" "),t("p",[s._v("æ­¤å¤„éœ€è¦æ‚¨åˆ›å»ºäº†ä¸€ä¸ª test-vite çš„é¡¹ç›®ï¼š"),t("code",[s._v("ssh://git@127.0.*.*:***/test/test-vite.git")])]),s._v(" "),t("p",[s._v("å¹¶é€šè¿‡ "),t("code",[s._v("yarn create @vitejs/app")]),s._v(" åˆå§‹åŒ–äº†å‰ç«¯ä»£ç ")]),s._v(" "),t("h4",{attrs:{id:"webhookè¯·æ±‚é…ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webhookè¯·æ±‚é…ç½®"}},[s._v("#")]),s._v(" webhookè¯·æ±‚é…ç½®")]),s._v(" "),t("p",[s._v("ä½¿ç”¨rootè´¦æˆ·è¿›è¡Œè®¾ç½®ï¼ˆå¦‚æœä½ å°†gitlabéƒ¨ç½²åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œè¿™é‡Œå°±å¯ä»¥ç•¥è¿‡äº†ï¼‰ï¼š")]),s._v(" "),t("p",[t("img",{attrs:{src:a(384),alt:"image.png"}}),s._v("\nâ€‹")]),s._v(" "),t("h3",{attrs:{id:"jenkins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[s._v("#")]),s._v(" jenkins")]),s._v(" "),t("h4",{attrs:{id:"æ’ä»¶å®‰è£…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ’ä»¶å®‰è£…"}},[s._v("#")]),s._v(" æ’ä»¶å®‰è£…")]),s._v(" "),t("p",[s._v("æ‰‹åŠ¨æœç´¢å®‰è£…ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("gitlab")]),s._v(" "),t("li",[s._v("nodejs")])]),s._v(" "),t("h4",{attrs:{id:"ç³»ç»Ÿè®¾ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç³»ç»Ÿè®¾ç½®"}},[s._v("#")]),s._v(" ç³»ç»Ÿè®¾ç½®")]),s._v(" "),t("p",[s._v("ç³»ç»Ÿè®¾ç½® - ç³»ç»Ÿé…ç½®")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å–æ¶ˆæ‰“å‹¾ Gitlabï¼šEnable authentication for '/project' end-point")])])]),s._v(" "),t("p",[s._v("ç³»ç»Ÿè®¾ç½® - å…¨å±€å·¥å…·é…ç½®")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å®‰è£…Nodejsã€‚Global npm packages to install æ­¤å¤„å¯ä»¥å¡«å†™ yarnï¼ˆæ ¹æ®é¡¹ç›®æ¥ï¼Œä¹Ÿå¯ä»¥ä¸å¡«ï¼Œæ‰‹åŠ¨é€šè¿‡npmå®‰è£…ï¼‰")])])]),s._v(" "),t("h4",{attrs:{id:"é…ç½®-gitlab-æ‹‰å–ä»£ç æƒé™è®¤è¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-gitlab-æ‹‰å–ä»£ç æƒé™è®¤è¯"}},[s._v("#")]),s._v(" é…ç½® gitlab æ‹‰å–ä»£ç æƒé™è®¤è¯")]),s._v(" "),t("p",[s._v("å½“ç„¶äº†ï¼Œæ­¤æ—¶çš„ jenkins è‚¯å®šæ˜¯åŒ¿åï¼Œæ²¡æœ‰æƒé™æ‹‰å–ä»£ç çš„ã€‚åˆ†åˆ«ç»™ jenkinsã€gitlab é…ä¸ª ssh ç§é’¥ã€å…¬é’¥å³å¯ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:a(385),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"ç”Ÿæˆå…¬é’¥ã€ç§é’¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿæˆå…¬é’¥ã€ç§é’¥"}},[s._v("#")]),s._v(" ç”Ÿæˆå…¬é’¥ã€ç§é’¥")]),s._v(" "),t("p",[s._v("è¿›å…¥jenkinså®¹å™¨ï¼Œä½¿ç”¨rootè´¦å·ç”Ÿæˆï¼š"),t("code",[s._v("ssh-keygen -t rsa")])]),s._v(" "),t("p",[s._v("ä¸€è·¯å›è½¦ï¼Œè¿›å…¥æç¤ºçš„ç›®å½•å°±å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªæ–‡ä»¶ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("id_rsa ç§é’¥")]),s._v(" "),t("li",[s._v("id_rsa.pub å…¬é’¥")])]),s._v(" "),t("p",[s._v("åˆ†åˆ« "),t("code",[s._v("cat")]),s._v(" å‡ºæ¥ï¼Œå¹¶å¤åˆ¶ã€‚")]),s._v(" "),t("h5",{attrs:{id:"é…ç½®å…¬é’¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®å…¬é’¥"}},[s._v("#")]),s._v(" é…ç½®å…¬é’¥")]),s._v(" "),t("p",[s._v("gitlab -> å¤´åƒ -> preferences -> ssh å¯†é’¥ -> ç²˜è´´å…¬é’¥ -> æ·»åŠ å¯†é’¥")]),s._v(" "),t("h5",{attrs:{id:"é…ç½®ç§é’¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®ç§é’¥"}},[s._v("#")]),s._v(" é…ç½®ç§é’¥")]),s._v(" "),t("p",[s._v("jenkins -> ç³»ç»Ÿç®¡ç† -> å‡­æ®ç®¡ç†ï¼ˆManage Credentailsï¼Œä¸æ˜¯å‡­æ®é…ç½®ï¼‰ -> æ·»åŠ å…¨å±€å‡­æ® -> é€‰æ‹© SSH... -> å¦‚å›¾")]),s._v(" "),t("p",[t("img",{attrs:{src:a(386),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"é…ç½®-nginx-æ¨é€æ–‡ä»¶çš„-ssh-å…å¯†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-nginx-æ¨é€æ–‡ä»¶çš„-ssh-å…å¯†"}},[s._v("#")]),s._v(" é…ç½® nginx æ¨é€æ–‡ä»¶çš„ ssh å…å¯†")]),s._v(" "),t("p",[s._v("ç”¨äº jenkins æ‰§è¡Œæ¨é€æ–‡ä»¶è„šæœ¬ï¼ŒåŒæ­¥æ–‡ä»¶åˆ°nginxæœåŠ¡å™¨ä¸Šã€‚")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥jenkins")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it myjenkins "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿›å…¥å")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1ã€ç”Ÿæˆå…¬é’¥ã€ç§é’¥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    ä¸€è·¯å›è½¦")]),s._v("\nssh-keygen\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2ã€æ·»åŠ å…¬é’¥ï¼Œè¿™é‡Œéœ€è¦è¾“å…¥ngnixæœåŠ¡å™¨çš„å¯†ç ï¼Œå°±æ˜¯ä¸Šæ–¹è„šæœ¬é‡Œå¤´çš„root:rootï¼Œå‰è€…ä¸ºç”¨æˆ·åï¼Œåè€…ä¸ºå¯†ç ã€‚")]),s._v("\nssh-copy-id -i ~/.ssh/id_rsa.pub root@nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å®Œæˆå…å¯†ï¼Œæµ‹è¯•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@nginx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("blockquote",[t("p",[s._v("è¡¥å……çŸ¥è¯†ï¼šsshé»˜è®¤ä¼šè¿22ç«¯å£ï¼Œå¯¹äºæœ¬æ¥å°±æš´éœ²22ç«¯å£çš„nginxå®¹å™¨æ¥è¯´æ— éœ€é…ç½®ï¼Œè€Œå¯¹äºå¤–éƒ¨çš„å®¿ä¸»æœºå°±éœ€è¦æŒ‡å®šæ˜ å°„çš„ç«¯å£ï¼š"),t("code",[s._v("ssh root@127.0.0.1 -p8022")])])]),s._v(" "),t("h2",{attrs:{id:"å®ç°-ci-cd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-ci-cd"}},[s._v("#")]),s._v(" å®ç° CI/CD")]),s._v(" "),t("p",[s._v("ä¸‹é¢ä»‹ç»Jenkinsåˆ›å»ºé¡¹ç›®ä¸­æœ€å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸­ä¸»æµè¿˜æ˜¯ pipelineã€‚")]),s._v(" "),t("h3",{attrs:{id:"æ–¹å¼1-é€šè¿‡-jenkins-freestyle"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹å¼1-é€šè¿‡-jenkins-freestyle"}},[s._v("#")]),s._v(" æ–¹å¼1ï¼šé€šè¿‡ Jenkins Freestyle")]),s._v(" "),t("p",[s._v("è‡ªç”±é£æ ¼éå¸¸ç®€å•ï¼šjenkinsæä¾›ä¸€ä¸ªå·¥ä½œç©ºé—´ï¼Œé€šè¿‡uié…ç½®shell")]),s._v(" "),t("h4",{attrs:{id:"æºç é…ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æºç é…ç½®"}},[s._v("#")]),s._v(" æºç é…ç½®ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("æºç åœ°å€ipéœ€æ›¿æ¢ä¸ºæ˜ å°„åœ°å€")]),s._v(" "),t("li",[s._v("Credentials å‡­è¯ï¼Œé€‰å–åˆšåˆšé…ç½®å¥½çš„")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(387),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"æ„å»ºè§¦å‘å™¨-é…åˆwebhook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ„å»ºè§¦å‘å™¨-é…åˆwebhook"}},[s._v("#")]),s._v(" æ„å»ºè§¦å‘å™¨ï¼ˆé…åˆwebHookï¼‰ï¼š")]),s._v(" "),t("p",[s._v("ç”Ÿæˆhookå¯†é’¥ï¼Œæ­¤æ—¶éœ€è¦å¤åˆ¶å‡ºï¼šç¬¬ä¸€ä¸ªçº¢æ¡†çš„é¡¹ç›®åœ°å€ï¼Œä»¥åŠç”Ÿæˆçš„tokenã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:a(388),alt:"image.png"}})]),s._v(" "),t("p",[s._v("è¿›å…¥Gitlab test-vite é¡¹ç›®ä¸­ï¼š")]),s._v(" "),t("p",[t("strong",[s._v("æ³¨æ„")]),s._v("ï¼šé¡¹ç›®åœ°å€ipéœ€æ›¿æ¢ä¸ºæ˜ å°„åœ°å€ï¼šhttp://jenkins:8080/project/FE/gitlab-test-01")]),s._v(" "),t("p",[t("img",{attrs:{src:a(389),alt:"image.png"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(390),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"æ„å»ºç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ„å»ºç¯å¢ƒ"}},[s._v("#")]),s._v(" æ„å»ºç¯å¢ƒ")]),s._v(" "),t("p",[t("img",{attrs:{src:a(391),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"æ„å»ºè„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ„å»ºè„šæœ¬"}},[s._v("#")]),s._v(" æ„å»ºè„šæœ¬")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ³¨å…¥ ci æ„å»ºç¯å¢ƒ JSON")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'"GIT_BRANCH":"\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GIT_BRANCH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'","GIT_COMMIT":"\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GIT_COMMIT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'","GIT_COMMITTER_NAME":"\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GIT_COMMITTER_NAME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'","GIT_URL":"\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GIT_URL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./build-env.json\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('":a;N;s/'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('//g;ta"')]),s._v(" ./build-env.json\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ†æ”¯å æå–ç¯å¢ƒ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ***/master -> master")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ***/k.*** -> k")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GIT_BRANCH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("##")]),s._v("*"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${var"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%%")]),s._v(".*}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ¨é€è‡³ç¯å¢ƒï¼š'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ„å»º")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ¨é€æ–‡ä»¶")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root@nginx"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("targetDir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/share/nginx/html/'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var")]),s._v('"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$server")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mkdir -p '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$targetDir")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" -r ./dist/* "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$server")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$targetDir")]),s._v('"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("h3",{attrs:{id:"æ–¹å¼2-é€šè¿‡-jenkins-pipeline"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹å¼2-é€šè¿‡-jenkins-pipeline"}},[s._v("#")]),s._v(" æ–¹å¼2ï¼šé€šè¿‡ Jenkins Pipeline")]),s._v(" "),t("p",[s._v("pipelineæ¯”è¾ƒçµæ´»")]),s._v(" "),t("ul",[t("li",[s._v("å¯ä»¥æŒ‡å®šèŠ‚ç‚¹ï¼ˆä»£ç†ï¼‰ï¼Œæ„å»ºé¡¹ç›®")]),s._v(" "),t("li",[s._v("å¯ä»¥æœ‰å¤šä¸ªå·¥ä½œç©ºé—´")]),s._v(" "),t("li",[s._v("å¯ä»¥é€šè¿‡å°†è„šæœ¬å†™åœ¨Jenkinsfileæ–‡ä»¶ï¼Œå’Œä»£ç ä¸€èµ·ç®¡ç†")]),s._v(" "),t("li",[s._v("å¯ä»¥åˆ†æ­¥éª¤å†™ci/cdè¿‡ç¨‹ï¼Œå¹¶æä¾›å¯è§†åŒ–ï¼Œæ–¹ä¾¿å®šä½é—®é¢˜")]),s._v(" "),t("li",[s._v("...")])]),s._v(" "),t("h4",{attrs:{id:"æ„å»ºè§¦å‘å™¨-é…åˆ-webhook"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ„å»ºè§¦å‘å™¨-é…åˆ-webhook"}},[s._v("#")]),s._v(" æ„å»ºè§¦å‘å™¨ï¼ˆé…åˆ webHook ï¼‰")]),s._v(" "),t("p",[s._v("åŒè‡ªç”±é£æ ¼")]),s._v(" "),t("h4",{attrs:{id:"æµæ°´çº¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æµæ°´çº¿"}},[s._v("#")]),s._v(" æµæ°´çº¿")]),s._v(" "),t("p",[s._v("è„šæœ¬è·¯å¾„ä¸å»ºè®®ä¿®æ”¹ï¼Œé»˜è®¤æ ¹ç›®å½•ä¸‹çš„ Jenkinsfile å°±å¥½ã€‚")]),s._v(" "),t("p",[t("img",{attrs:{src:a(392),alt:"image.png"}})]),s._v(" "),t("h4",{attrs:{id:"ç¼–å†™-jenkinsfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™-jenkinsfile"}},[s._v("#")]),s._v(" ç¼–å†™ Jenkinsfile")]),s._v(" "),t("p",[s._v("åœ¨æ ¹ç›®å½•åˆ›å»ºè¯¥æ–‡ä»¶ï¼Œå¹¶å¡«å†™å¦‚ä¸‹è„šæœ¬ã€‚")]),s._v(" "),t("p",[s._v("ä¸ºæ–¹ä¾¿è¯»è€…é˜…è¯»å’Œç†è§£ï¼Œè¯¥è„šæœ¬åšæœªæ‹†åˆ†ï¼Œä¸” buildEnv ä¸ºå‡ ä¹æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ï¼Œå®é™…æŒ‰éœ€å¼•ç”¨å³å¯ã€‚")]),s._v(" "),t("div",{staticClass:"language-groovy line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-groovy"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" buildEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" deployEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'k'")]),s._v("\n\npipeline "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n  agent any\n\n  stages "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PatchEnv'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      steps "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        script "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          buildEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"""\n          {\n            \\"BRANCH_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BRANCH_NAME")]),s._v('\\",\n            \\"BRANCH_IS_PRIMARY\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BRANCH_IS_PRIMARY")]),s._v('\\",\n            \\"CHANGE_ID\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_ID")]),s._v('\\",\n            \\"CHANGE_URL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_URL")]),s._v('\\",\n            \\"CHANGE_TITLE\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_TITLE")]),s._v('\\",\n            \\"CHANGE_AUTHOR\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_AUTHOR")]),s._v('\\",\n            \\"CHANGE_AUTHOR_DISPLAY_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_AUTHOR_DISPLAY_NAME")]),s._v('\\",\n            \\"CHANGE_AUTHOR_EMAIL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_AUTHOR_EMAIL")]),s._v('\\",\n            \\"CHANGE_TARGET\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_TARGET")]),s._v('\\",\n            \\"CHANGE_BRANCH\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_BRANCH")]),s._v('\\",\n            \\"CHANGE_FORK\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CHANGE_FORK")]),s._v('\\",\n            \\"TAG_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TAG_NAME")]),s._v('\\",\n            \\"TAG_TIMESTAMP\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TAG_TIMESTAMP")]),s._v('\\",\n            \\"TAG_UNIXTIME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TAG_UNIXTIME")]),s._v('\\",\n            \\"TAG_DATE\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TAG_DATE")]),s._v('\\",\n            \\"CI\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CI")]),s._v('\\",\n            \\"BUILD_NUMBER\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BUILD_NUMBER")]),s._v('\\",\n            \\"BUILD_ID\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BUILD_ID")]),s._v('\\",\n            \\"BUILD_DISPLAY_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BUILD_DISPLAY_NAME")]),s._v('\\",\n            \\"JOB_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JOB_NAME")]),s._v('\\",\n            \\"JOB_BASE_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JOB_BASE_NAME")]),s._v('\\",\n            \\"BUILD_TAG\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BUILD_TAG")]),s._v('\\",\n            \\"EXECUTOR_NUMBER\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("EXECUTOR_NUMBER")]),s._v('\\",\n            \\"NODE_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NODE_NAME")]),s._v('\\",\n            \\"NODE_LABELS\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NODE_LABELS")]),s._v('\\",\n            \\"WORKSPACE\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("WORKSPACE")]),s._v('\\",\n            \\"WORKSPACE_TMP\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("WORKSPACE_TMP")]),s._v('\\",\n            \\"JENKINS_HOME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JENKINS_HOME")]),s._v('\\",\n            \\"JENKINS_URL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JENKINS_URL")]),s._v('\\",\n            \\"BUILD_URL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BUILD_URL")]),s._v('\\",\n            \\"JOB_URL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("JOB_URL")]),s._v('\\",\n            \\"GIT_COMMIT\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_COMMIT")]),s._v('\\",\n            \\"GIT_PREVIOUS_COMMIT\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_PREVIOUS_COMMIT")]),s._v('\\",\n            \\"GIT_PREVIOUS_SUCCESSFUL_COMMIT\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_PREVIOUS_SUCCESSFUL_COMMIT")]),s._v('\\",\n            \\"GIT_BRANCH\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_BRANCH")]),s._v('\\",\n            \\"GIT_LOCAL_BRANCH\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_LOCAL_BRANCH")]),s._v('\\",\n            \\"GIT_CHECKOUT_DIR\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_CHECKOUT_DIR")]),s._v('\\",\n            \\"GIT_URL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_URL")]),s._v('\\",\n            \\"GIT_COMMITTER_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_COMMITTER_NAME")]),s._v('\\",\n            \\"GIT_AUTHOR_NAME\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_AUTHOR_NAME")]),s._v('\\",\n            \\"GIT_COMMITTER_EMAIL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_COMMITTER_EMAIL")]),s._v('\\",\n            \\"GIT_AUTHOR_EMAIL\\":\\"'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_AUTHOR_EMAIL")]),s._v('\\"\n          }\n          """')]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¿ç•™å¼•å·çš„è½¬ä¹‰å­—ç¬¦")]),s._v("\n          buildEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" buildEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replaceAll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string regex"}},[s._v('/"/')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\\\\\\\\"'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          deployEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GIT_BRANCH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replaceAll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string regex"}},[s._v("/^.*\\//")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replaceAll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string regex"}},[s._v("/\\..*$/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        echo "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"æ„å»ºç¯å¢ƒï¼š'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("buildEnv")]),s._v('"')]),s._v("\n        echo "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"éƒ¨ç½²ç¯å¢ƒï¼š'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("deployEnv")]),s._v('"')]),s._v("\n        sh "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"""\n          # æ³¨å…¥ ci æ„å»ºç¯å¢ƒ JSON\n          echo "'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("buildEnv")]),s._v('" > ./build-env.json\n        """')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Build'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      steps "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nodejs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node-16.3.0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          sh "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"""\n            # æ„å»º\n            yarn\n            yarn build\n          """')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Deploy'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      steps "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        sh "),t("span",{pre:!0,attrs:{class:"token string gstring"}},[s._v('"""\n          # æ¨é€æ–‡ä»¶\n          server="root@nginx"\n          targetDir="/usr/share/nginx/html/'),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),s._v("deployEnv")]),s._v('"\n\n          echo "éƒ¨ç½²ç›®å½•ï¼š"\n          echo \\$targetDir\n\n          ssh "\\$server" "mkdir -p \\$targetDir"\n          scp -r ./dist/* "\\$server:\\$targetDir"\n        """')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br")])]),t("h4",{attrs:{id:"jenkinsfile-ç¼–å†™å»ºè®®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkinsfile-ç¼–å†™å»ºè®®"}},[s._v("#")]),s._v(" Jenkinsfile ç¼–å†™å»ºè®®ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä¸è¦åœ¨ Jenkinsfile å†™å¤ªå¤šæˆ–å¤æ‚çš„è„šæœ¬ã€‚å¯ä»¥é€šè¿‡æ‹†åˆ†ä¸ºå¤–éƒ¨ .sh æ–‡ä»¶ï¼Œæ¥æ‰§è¡Œ")]),s._v(" "),t("li",[s._v("ä¸è¦å°†è„šæœ¬æ‰æˆä¸€å›¢ï¼Œå†™åœ¨ä¸€èµ·ã€‚é…åˆ Jenkinsfile ï¼Œæ‹†åˆ† stageã€step ï¼Œä»¥è¾¾åˆ°å¯è§†åŒ–çš„æ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(393),alt:"image.png"}})]),s._v(" "),t("h2",{attrs:{id:"ç»“æŸè¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“æŸè¯­"}},[s._v("#")]),s._v(" ç»“æŸè¯­")]),s._v(" "),t("p",[s._v("é€šè¿‡é˜…è¯»æœ¬æ–‡ï¼Œç›¸ä¿¡ä½ å·²ç»åŸºæœ¬äº†è§£ Dockerï¼Œå¹¶æ¸…æ¥š Jenkins çš„è¿ä½œæµç¨‹ï¼Œå…¶æ— éå°±æ˜¯é€šè¿‡ hook æˆ–è€… è½®è¯¢ï¼Œè§¦å‘è„šæœ¬ã€‚äº‹å®ä¸Š Jenkins ç¡®å®å°±æ˜¯è¿™æ ·ä¸€ä¸ªâ€œå°å·¥å…·â€ï¼Œæ›´å¤šçš„è¿˜æ˜¯éœ€è¦é è‡ªå·±ç¼–å†™è„šæœ¬å®ç°å„ç§éœ€æ±‚ã€‚\nâ€‹")]),s._v(" "),t("p",[s._v("å¦‚æœä½ çš„å›¢é˜Ÿæ¯æ¬¡æ›´æ–°ä»£ç è¿˜éœ€è¦æ‰‹åŠ¨æ„å»ºã€éƒ¨ç½²ï¼Œé‚£ä¹ˆå¼ºçƒˆå»ºè®®ç”¨é—²ç½®çš„ç”µè„‘ï¼ŒæŒ‰ç…§æœ¬æ–‡çš„æ“ä½œå®ç° CI/CD ï¼Œè®©è‡ªå·±è§£æ”¾åŒæ‰‹ï¼Œèšç„¦å…¶ä»–æ›´æœ‰æ„ä¹‰çš„äº‹æƒ…ä¸Šã€‚")]),s._v(" "),t("p",[s._v("æœ€åï¼Œå¼ºçƒˆå»ºè®®ç»§ç»­é˜…è¯»å®˜æ–¹çš„ä¸¤ä¸ªæœ€ä½³å®è·µï¼š")]),s._v(" "),t("ul",[t("li",[s._v("pipeline æœ€ä½³å®è·µï¼š"),t("a",{attrs:{href:"https://www.jenkins.io/doc/book/pipeline/pipeline-best-practices/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.jenkins.io/doc/book/pipeline/pipeline-best-practices/"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("ä½¿ç”¨npmæ„å»ºNode.jså’ŒReactåº”ç”¨ï¼š"),t("a",{attrs:{href:"https://www.jenkins.io/zh/doc/tutorials/build-a-node-js-and-react-app-with-npm/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.jenkins.io/zh/doc/tutorials/build-a-node-js-and-react-app-with-npm/"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=e.exports}}]);